dist: bionic
os: linux
arch: arm64

notifications:
  email: false

language: c

# blocklist
branches:
  except:
    - gh-pages

env:
  jobs:
  - BOARD='afc-bpm'        -VERSION='3.0' -RTM=''
  - BOARD='afc-bpm'        -VERSION='3.1' -RTM=''
  - BOARD='afc-timing'     -VERSION=''    -RTM='rtm-8sfp'

# Install dependencies
addons:
  apt:
    packages:
      - gcc-arm-none-eabi
      - libnewlib-arm-none-eabi
      - cmake
      - doxygen
      - doxygen-doc
      - doxygen-latex
      - doxygen-gui
      - graphviz

script:
  - mkdir build_$BOARD_$VERSION && cd build_$BOARD_$VERSION && cmake ../ -DBOARD=$BOARD -DVERSION=$VERSION -DBOARD_RTM=$RTM -DCMAKE_BUILD_TYPE=Release && make

  # Generate and deploy documentation
after_success:
  - cd $TRAVIS_BUILD_DIR/docs && doxygen Doxyfile.dox && echo "" > html/.nojekyll && ls -la html
